# -*- coding: utf-8 -*-
"""UnitTest.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1MIUdEcpESV4-M6um1qXbj0uERD6DueyF
"""

#UNIT TEST

import unittest
import pandas as pd

class TestFilterAndCalculate(unittest.TestCase):

    def setUp(self):
        #sample DataFrame for testing
        self.sample_data = {
            'Source_Group_Id': ['org.glassfish.distributions', 'org.glassfish.connectors'],
            'Source_Artifact_Id': ['web', 'descriptors'],
            'Source_Version': ['3.1.1-b07', '3.1-b36'],
            'Source Release Date': ['2016-08-10T15:08:35Z[GMT]', '2016-08-10T15:08:35Z[GMT]'],
            'Source Release Year': [2016, 2016],
            'Target_Group_Id': ['org.glassfish.distributions', 'org.glassfish.packager'],
            'Target_Artifact_Id': ['glassfish', 'glassfish-jca'],
            'Target_Version': ['3.1.1-b07', '3.1-b36'],
            'Target Release Date': ['2016-08-10T15:08:35Z[GMT]', '2016-08-10T15:08:35Z[GMT]'],  # Corrected release date
            'Target Release Year': [2016, 2011]
        }
        self.df = pd.DataFrame(self.sample_data)

    # Testing function with known inputs and expected outputs
    def test_filtered_df(self):

        result = filter_and_calculate(self.df)


        expected_unique_target_group_ids = set(['org.glassfish.distributions', 'org.glassfish.packager'])
        self.assertEqual(set(result['Target_Group_Id']), expected_unique_target_group_ids)

        # Check if the first and last release dates are calculated correctly
        expected_first_release_date = '2016-08-10T15:08:35Z[GMT]'
        expected_last_release_date = '2016-08-10T15:08:35Z[GMT]'  # Corrected last release date
        self.assertEqual(result['Target_first_release_date'].iloc[0], expected_first_release_date)
        self.assertEqual(result['Target_last_release_date'].iloc[0], expected_last_release_date)

        # correctly filtered?
        expected_version_count = 1
        self.assertEqual(result['version_count'].iloc[0], expected_version_count)

#unit tests
unittest.main(argv=[''], exit=False)